<div 
  [class]="contactItemClasses"
  (click)="onContactClick()"
>
  <!-- Avatar with online status -->
  <div class="relative">
    <div class="w-9 h-9 rounded-full bg-gradient-to-br from-[var(--primary-color-light)] to-[var(--primary-color)] flex items-center justify-center text-white font-medium text-xs">
      @if ((conversation.name || getOtherParticipantName())) {
        {{ getInitials(conversation.name || getOtherParticipantName()) }}
      }
      @else {
        <mat-icon>person</mat-icon>
      }
    </div>
    <!-- Online status indicator -->
    @if (getOtherParticipant()?.isOnline) {
      <div 
        class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-white rounded-full"
      ></div>
    }
  </div>
  
  <!-- Contact Info -->
  <div class="flex-1 min-w-0">
    <div class="flex items-center justify-between">
      <h3 [class]="nameClasses">
        {{ conversation.name || getOtherParticipantName() }}
      </h3>
      <span class="text-[11px] text-gray-400 ml-2 flex-shrink-0">
        {{ formatLastMessageTime(conversation.lastMessage?.timestamp) }}
      </span>
    </div>
    
    <div class="flex items-center justify-between mt-0">
      <p [class]="lastMessageClasses">
        @if (conversation.lastMessage) {
          <span>{{ conversation.lastMessage.content }}</span>
        }
        @else {
          <span class="italic">No messages yet</span>
        }
      </p>
      
      <!-- Unread count badge -->
      @if ((conversation.unreadCount || 0) > 0) {
        <div 
          class="bg-[var(--primary-color)] text-white text-xs rounded-full min-w-[18px] h-4 flex items-center justify-center px-1 font-medium"
        >
          {{ (conversation.unreadCount || 0) > 99 ? '99+' : (conversation.unreadCount || 0) }}
        </div>
      }
    </div>
  </div>
</div>
